# SQL Challenge

The database contains three tables: marketing_performance, website_revenue, and campaign_info. Refer to the CSV
files to understand how these tables have been created.

`marketing_performance` contains daily ad spend and performance metrics -- impression, clicks, and conversions -- by campaign_id and location:
```sql
create table marketing_data (
 date datetime,
 campaign_id varchar(50),
 geo varchar(50),
 cost float,
 impressions float,
 clicks float,
 conversions float
);
```

`website_revenue` contains daily website revenue data by campaign_id and state:
```sql
create table website_revenue (
 date datetime,
 campaign_id varchar(50),
 state varchar(2),
 revenue float
);
```

`campaign_info` contains attributes for each campaign:
```sql
create table campaign_info (
 id int not null primary key auto_increment,
 name varchar(50),
 status varchar(50),
 last_updated_date datetime
);
```

### Challenge Submit Instructions

1. Fork the repository
2. Answer the questions below in a single SQL file - e.g answers.sql
3. Provide Link to Forked Repository to PMG PMG Talent Acquisition Team

### Please provide a SQL statement for each question

1. Write a query to get the sum of impressions by day.

select 
date as day,
sum(A.impressions) as Impressions
 from marketing_performance A
 group by date  

2. Write a query to get the top three revenue-generating states in order of best to worst. How much revenue did the third best state generate?

select 
 B.state, 
sum(B.revenue) as Revenue
 from website_revenue B 
 group by state 
 order by Revenue desc

Ohio was third best with $37,577

3. Write a query that shows total cost, impressions, clicks, and revenue of each campaign. Make sure to include the campaign name in the output.

select 
 c.name,
 sum(A.cost) as Cost,
 sum(A.impressions) as Impressions,
 sum(A.clicks) as Clicks,
 sum(B.revenue) as Revenue
 from marketing_performance A left join campaign_info C on A.campaign_id = C.id
 left join website_revenue B on A.campaign_id = B.campaign_id
 group by c.name


4. Write a query to get the number of conversions of Campaign5 by state. Which state generated the most conversions for this campaign?

select
 A.geo as State,
 sum(A.conversions) as Conversions
 from marketing_performance A left join campaign_info C on A.campaign_id = C.id
 where C.id = 99058240
 group by A.geo

Georgia- state with most conversions

5. In your opinion, which campaign was the most efficient, and why?

Per query three, Campaign 3 has the highest number of impressions and clicks, was the lowest cost, and had the highest revenue. Therefore, it is the most efficient campaign. To enhance this analysis, you could calculate the ROA, or return on ad spend, by subtracting costs from revenues for each campaign.

**Bonus Question**

6. Write a query that showcases the best day of the week (e.g., Sunday, Monday, Tuesday, etc.) to run ads.

select 
 a.date as date,
 datename(WEEKDAY,a.date) as day,
 sum(A.cost) as Cost,
 sum(A.impressions) as Impressions,
 sum(A.clicks) as Clicks,
 sum(B.revenue) as Revenue,
 sum(B.revenue-A.cost) as ROA
 from marketing_performance A left join campaign_info C on A.campaign_id = C.id
 left join website_revenue B on A.campaign_id = B.campaign_id
 group by a.date
order by ROA desc

Friday is the best day to run a campaign because it has the highest summed revenues and ROA (revenues- costs). It would be most effective to group on the alias column (day) to calculate this. 
